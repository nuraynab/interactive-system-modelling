# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'sem_mem.ui'
#
# Created by: PyQt5 UI code generator 5.15.1
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets
from PyQt5.QtWidgets import (QApplication, QWidget, QMessageBox)
import csv
from itertools import zip_longest
import pandas
import io
import MySQLdb as mdb
from contextlib import closing
from result_semantic_memory import Ui_ResultsSemanticMemoryWindow


class Ui_QAResWindow(QWidget):
    def setupUi(self, QAResWindow):
        QAResWindow.setObjectName("QAResWindow")
        QAResWindow.resize(1159, 861)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Preferred, QtWidgets.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(QAResWindow.sizePolicy().hasHeightForWidth())
        QAResWindow.setSizePolicy(sizePolicy)
        self.centralwidget = QtWidgets.QWidget(QAResWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.label = QtWidgets.QLabel(self.centralwidget)
        self.label.setGeometry(QtCore.QRect(40, 10, 591, 51))
        self.label.setObjectName("label")
        self.line = QtWidgets.QFrame(self.centralwidget)
        self.line.setGeometry(QtCore.QRect(0, 70, 1161, 16))
        self.line.setFrameShape(QtWidgets.QFrame.HLine)
        self.line.setFrameShadow(QtWidgets.QFrame.Sunken)
        self.line.setObjectName("line")
        self.label_4 = QtWidgets.QLabel(self.centralwidget)
        self.label_4.setGeometry(QtCore.QRect(550, 140, 151, 51))
        self.label_4.setObjectName("label_4")
        self.tableWidget = QtWidgets.QTableWidget(self.centralwidget)
        self.tableWidget.setGeometry(QtCore.QRect(80, 200, 991, 511))
        font = QtGui.QFont()
        font.setPointSize(14)
        self.tableWidget.setFont(font)
        self.tableWidget.setSelectionBehavior(QtWidgets.QTableView.SelectRows)
        self.tableWidget.setLineWidth(1)
        self.tableWidget.setTextElideMode(QtCore.Qt.ElideRight)
        self.tableWidget.setShowGrid(True)
        self.tableWidget.setWordWrap(True)
        self.tableWidget.setCornerButtonEnabled(True)
        self.tableWidget.setObjectName("tableWidget")
        self.tableWidget.setColumnCount(3)
        self.tableWidget.setRowCount(0)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        self.tableWidget.setVerticalHeaderItem(2, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignCenter)
        font = QtGui.QFont()
        font.setPointSize(14)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(0, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignCenter)
        font = QtGui.QFont()
        font.setPointSize(14)
        font.setStyleStrategy(QtGui.QFont.PreferAntialias)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(1, item)
        item = QtWidgets.QTableWidgetItem()
        item.setTextAlignment(QtCore.Qt.AlignCenter)
        font = QtGui.QFont()
        font.setPointSize(14)
        item.setFont(font)
        self.tableWidget.setHorizontalHeaderItem(2, item)
        self.tableWidget.horizontalHeader().setCascadingSectionResizes(False)
        self.tableWidget.horizontalHeader().setDefaultSectionSize(324)
        self.tableWidget.horizontalHeader().setMinimumSectionSize(71)
        self.tableWidget.horizontalHeader().setSortIndicatorShown(False)
        self.tableWidget.verticalHeader().setCascadingSectionResizes(False)
        self.tableWidget.verticalHeader().setDefaultSectionSize(26)
        self.label_2 = QtWidgets.QLabel(self.centralwidget)
        self.label_2.setGeometry(QtCore.QRect(40, 80, 351, 51))
        self.label_2.setObjectName("label_2")
        self.label_2.setFont(font)
        self.label_3 = QtWidgets.QLabel(self.centralwidget)
        self.label_3.setGeometry(QtCore.QRect(40, 120, 351, 51))
        self.label_3.setObjectName("label_3")
        self.label_3.setFont(font)
        self.label_6 = QtWidgets.QLabel(self.centralwidget)
        self.label_6.setGeometry(QtCore.QRect(900, 750, 241, 51))
        self.label_6.setObjectName("label_6")
        self.label_6.setFont(font)
        font = QtGui.QFont()
        font.setPointSize(14)
        self.saveBtn = QtWidgets.QPushButton(self.centralwidget)
        self.saveBtn.setGeometry(QtCore.QRect(900, 10, 191, 41))
        self.saveBtn.setFont(font)
        self.saveBtn.setObjectName("saveBtn")
        # self.semanticMemBtn = QtWidgets.QPushButton(self.centralwidget)
        # self.semanticMemBtn.setGeometry(QtCore.QRect(680, 10, 200, 41))
        # self.semanticMemBtn.setFont(font)
        # self.semanticMemBtn.setObjectName("semanticMemBtn")
        self.tableWidget.raise_()
        self.label.raise_()
        self.line.raise_()
        self.label_4.raise_()
        self.label_2.raise_()
        self.label_3.raise_()
        QAResWindow.setCentralWidget(self.centralwidget)
        self.menubar = QtWidgets.QMenuBar(QAResWindow)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 1159, 22))
        self.menubar.setObjectName("menubar")
        self.menuInteractive_System_Modelling = QtWidgets.QMenu(self.menubar)
        self.menuInteractive_System_Modelling.setObjectName("menuInteractive_System_Modelling")
        QAResWindow.setMenuBar(self.menubar)
        self.statusbar = QtWidgets.QStatusBar(QAResWindow)
        self.statusbar.setObjectName("statusbar")
        QAResWindow.setStatusBar(self.statusbar)
        self.menubar.addAction(self.menuInteractive_System_Modelling.menuAction())

        self.retranslateUi(QAResWindow)
        QtCore.QMetaObject.connectSlotsByName(QAResWindow)

        self.version_id = QtWidgets.QLabel(self.centralwidget)
        self.version_id.setGeometry(QtCore.QRect(0, 0, 0, 0))
        self.version_id.setObjectName("version_id")

        self.saveBtn.clicked.connect(self.saveFile)
        # self.semanticMemBtn.clicked.connect(self.openSemanticMem)

    # def openSemanticMem(self):
    #     self.ResultsSemanticMemoryWindow = QtWidgets.QMainWindow()
    #     self.ui = Ui_ResultsSemanticMemoryWindow()
    #     self.ui.setupUi(self.ResultsSemanticMemoryWindow)
    #     self.ui.label_2.setText(self.label_2.text())
    #     self.ui.label_3.setText(self.label_3.text())
    #     self.ui.version_id.setText(self.version_id.text())
    #     self.ResultsSemanticMemoryWindow.show()


    def saveFile(self):
                
        newFileDir, _ = QtWidgets.QFileDialog.getSaveFileName(self.centralwidget, "Save File", QtCore.QDir.currentPath() , '*.csv')

        with open('{}.csv'.format(newFileDir), 'w') as dbFile:
            wr = csv.writer(dbFile)
            wr.writerow(("Question", "Answer", "Time taken"))

            for row in range(self.tableWidget.rowCount()):
                question = self.tableWidget.item(row, 0)
                answer = self.tableWidget.item(row, 1)
                time = self.tableWidget.item(row, 2)

                wr.writerow((question.text(), answer.text(), time.text()))
            QtWidgets.QMessageBox.about(self.centralwidget,'Connection', 'Data Saved Successfully')

    def retranslateUi(self, QAResWindow):
        _translate = QtCore.QCoreApplication.translate
        QAResWindow.setWindowTitle(_translate("QAResWindow", "MainWindow"))
        self.label.setText(_translate("QAResWindow", "<html><head/><body><p><span style=\" font-size:28pt;\">Results</span></p></body></html>"))
        # self.label_4.setText(_translate("QAResWindow", "<html><head/><body><p><span style=\" font-size:20pt;\">Facts</span></p></body></html>"))
        item = self.tableWidget.horizontalHeaderItem(0)
        item.setText(_translate("QAResWindow", "Question"))
        item = self.tableWidget.horizontalHeaderItem(1)
        item.setText(_translate("QAResWindow", "Answer"))
        item = self.tableWidget.horizontalHeaderItem(2)
        item.setText(_translate("QAResWindow", "Time taken (sec)"))
        __sortingEnabled = self.tableWidget.isSortingEnabled()
        self.tableWidget.setSortingEnabled(False)
        self.tableWidget.setSortingEnabled(__sortingEnabled)
        self.saveBtn.setText(_translate("QAResWindow", "Save"))
        # self.semanticMemBtn.setText(_translate("QAResWindow", "Semantic Memory"))
        self.menuInteractive_System_Modelling.setTitle(_translate("QAResWindow", "1"))
